// Mission: Assassination Contract
// Campaign: Main Campaign
// Act: 2 - Escalation
// Mission: 001

(function() {
    const mission = {
        id: 'main-02-001',
        campaign: 'main',
        act: 2,
        missionNumber: 1,

        name: 'Assassination Contract',
        title: 'Slums Extraction',
        description: 'Eliminate Nexus Corp\'s criminal enforcers who control the slums district.',
        briefing: 'The recon data revealed something disturbing - Nexus Corp uses local crime syndicates as muscle and recruitment pools for their private army. This slums district in Manila is controlled by one such syndicate. Their boss and lieutenants are on Nexus payroll, kidnapping people for "test subjects." We\'re putting an end to this. Eliminate the crime boss and his lieutenants, but avoid harming civilians - they\'re victims here, not enemies.',
        storyContext: 'Nexus Corp\'s reach extends into the criminal underworld. Cut off their enforcers before the final assault.',
        region: 'asia',
        location: 'Manila',

        agents: {
            max: 5,
            required: 2,
            recommended: 4
        },

        map: {
            type: 'residential',
            name: 'Slums District',
            width: 90,
            height: 60,
            spawn: { x: 2, y: 58 },
            extraction: { x: 88, y: 2 },

            generation: {
                baseType: 'floor',
                borders: true,

                apartmentBuildings: [
                    { x: 10, y: 10, width: 20, height: 15 },
                    { x: 35, y: 10, width: 20, height: 15 },
                    { x: 60, y: 10, width: 20, height: 15 },
                    { x: 10, y: 35, width: 20, height: 15 },
                    { x: 60, y: 35, width: 20, height: 15 }
                ],

                centralPark: { x: 35, y: 25, width: 20, height: 10 },

                streets: [
                    { type: 'horizontal', y: 30, x1: 0, x2: 89 },
                    { type: 'vertical', x: 45, y1: 0, y2: 59 }
                ]
            },

            embedded: {
                tiles: [
                    "######################################################################################....",
                    "#.........................................................................................",
                    "#.........................................................................................",
                    "#.........................................................................................",
                    "#.........................................................................................",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    "#........................................................................................#",
                    ".........................................................................................#",
                    ".........................................................................................#",
                    ".........................................................................................#",
                    ".....#####################################################################################"
                ],
                spawn: { x: 2, y: 58 },
                extraction: { x: 88, y: 2 },
                doors: [],
                coverCount: 60
            },

            enemySpawns: [
                { x: 20, y: 15 }, { x: 45, y: 15 }, { x: 70, y: 15 },
                { x: 20, y: 40 }, { x: 70, y: 40 },
                { x: 45, y: 30 }
            ],

            coverPositions: 60
        },

        objectives: [
            {
                id: 'eliminate_primary',
                type: 'eliminate',
                target: 'crime_boss',
                count: 1,
                required: true,
                description: 'Eliminate crime boss',
                displayText: 'Crime boss eliminated: {current}/{required}'
            },
            {
                id: 'eliminate_lieutenants',
                type: 'eliminate',
                target: 'lieutenant',
                count: 2,
                required: true,
                description: 'Eliminate lieutenants',
                displayText: 'Lieutenants eliminated: {current}/{required}'
            },
            {
                id: 'avoid_civilians',
                type: 'custom',
                required: false,
                description: 'No civilian casualties',
                displayText: 'Clean operation: No civilian casualties',
                checkFunction: 'checkNoCivilianCasualties',
                rewards: { credits: 400, researchPoints: 15 }
            },
            {
                id: 'keep_agents_alive',
                type: 'custom',
                required: false,
                description: 'Keep all agents alive',
                displayText: 'Perfect extraction: All agents alive',
                checkFunction: 'checkAgentsAlive',
                minAgents: 4,
                rewards: { credits: 750, researchPoints: 40 }
            }
        ],

        enemies: {
            count: 8,
            types: ['guard', 'soldier'],
            special: ['crime_boss', 'lieutenant', 'lieutenant']
        },

        rewards: {
            credits: 4000,
            researchPoints: 125,
            worldControl: 5
        },

        // NPCs
        npcs: [
            {
                id: 'local_mother',
                spawn: { x: 10, y: 50 },  // Near spawn, in slums
                quests: ['find_evidence']
            },
            {
                id: 'ex_gang_member',
                spawn: { x: 35, y: 25 },  // Central area, hiding
                quests: ['inside_info']
            },
            {
                id: 'street_informant',
                spawn: { x: 65, y: 45 },  // Street corner
                quests: ['enemy_positions']
            },
            {
                id: 'slum_merchant',
                spawn: { x: 20, y: 35 },  // Near apartments
                quests: []  // Shop only
            }
        ]
    };

    if (typeof CampaignSystem !== 'undefined') {
        CampaignSystem.registerMission('main', 2, 'main-02-001', mission);
    }
    if (typeof window !== 'undefined') {
        window.CAMPAIGN_MISSIONS = window.CAMPAIGN_MISSIONS || {};
        window.CAMPAIGN_MISSIONS['main-02-001'] = mission;
    }
})();